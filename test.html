<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="/lib/phaser.js"></script>
</head>
<body>
<div id="game"></div>
</body>
<script type="text/javascript">

    var Test = {
        preload: function(){
            this.load.spritesheet('hero', 'assets/sprites/hero.png',{frameWidth:64,frameHeight:64});
        },

        create: function(){
            this.add.image(100,100,'hero');
            var id = 0;
            Test.loadJSON('/maps/chunk' + id + '.json', Test.drawChunk, id);
        }
    };

    Test.loadJSON = function(path,callback,data){
        var xobj = new XMLHttpRequest();
        xobj.overrideMimeType("application/json");
        xobj.open('GET', path, true);
        xobj.onreadystatechange = function () {
            if (xobj.readyState == 4 && xobj.status == "200") {
                // Required use of an anonymous callback as .open will NOT return a value but simply returns undefined in asynchronous mode
                callback(JSON.parse(xobj.responseText),data);
            }
        };
        xobj.send(null);
    };

    Test.drawChunk = function(data,id){
        console.log(data,id);
    };

    var config = {
        //type: (navigator.userAgent.toLowerCase().indexOf('firefox') > -1 ? Phaser.CANVAS : Phaser.AUTO),
        type: Phaser.WEBGL,
        width: 32*32,
        height: 32*18,
        parent: 'game',
        scene: [Test]
    };

    var game = new Phaser.Game(config);
</script>
</html>